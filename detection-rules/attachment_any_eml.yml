name: "Attachment: Any eml file"
description: |
  Potential EML file in message. Use this to grab EML files in attachments and 
  submit to binexplode. This rule may potentially be combined with a webhook 
  notification to submit the EML contents to the analysis API
type: "rule"
authors:
  - twitter: "und3rf10w"
source: |
  type.inbound
  and any(attachments,
  // ideally this would be off of a magic number, but that doesn't seem to exist for eml files
    .file_extension in~ ('eml')
     and any(beta.binexplode(.), .extension in~ ("eml"))
  )
